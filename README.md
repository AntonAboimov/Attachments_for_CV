# Attachments for CV
В данном разделе представлены примеры запросов SQL.

### _Файл: 1. Reg_bots_

Вывод цепочек пользователей от 10 чел., которые регистрировались подряд (время между регистрациями до 3х мин., id +1 или +2) и имеют одинаковые страну и язык.
Выводится дата регистрации первого пользователя и длина цепочки 


### _Файл: 2.1. Create_Tables_
Создание таблиц для запроса в п. 2.2. (опционально)

### _Файл: 2.2. Same_attribute_

Вывод случаев, когда у разных пользователей (от 5 чел.) совпадает один из атрибутов (номер карты/адрес/IP).   
Выводится:
* атрибут
* количество пользователей в данной группе с совпадающим атрибутом
* последовательность пользователей обнаруженных в группе
* дата первого попадания в базу с использованием данного атрибута пользователем
* дата обновления по этому совпадению

В отчет попадают только цепочки пользователей, у которых дата обновления (последнего пользователя) приходится на отчетную дату.


### _Файл: 3. Payment_retry_

Вывод количества повторных платежей пользователей, которые они сделали из-за того, что прошлый платеж не удался.
Распределение пользователей на три группы: «не смогли произвести оплату», «были как проблемные, так и успешные платежи», «проблемы с оплатой отсутствовали».


### _Файл: 4. Free_seats_&_Cumulative_pass-er_

Вывод количества свободных мест для каждого рейса, их % отношение к общему количеству мест в самолете.
Вывод суммарного количества вывезенных пассажиров из каждого аэропорта на каждый день накопительным итогом.  


### _Файл: 5. Flight_destination_

Расчет расстояния между аэропортами, связанными прямыми рейсами и сравнение с максимально допустимой дальностью полета самолетов, обслуживающих эти рейсы.


### _Файл: 6. TOP-1_rent_

Вывод перечисленных ниже показателей в разрезе каждого магазина:
* день, в который арендовали больше всего фильмов;
* количество фильмов, взятых в аренду в этот день;
* день, в который продали фильмов на наименьшую сумму;
* сумму продажи в этот день.
